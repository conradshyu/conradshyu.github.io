<!DOCTYPE html>
<!--
    written by Conrad Shyu (conrad.shyu@nih.gov)
    last updated on 12/20/2020
-->
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <title>Sudoku</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.js"></script>

    <style>
        tr, td {
            color: rgb(77, 77, 77);
            font-weight: normal;
            border: 1px solid lightgray;
            text-align: center;
            vertical-align: middle;
            border-radius: 4px;
            padding: 12px;
            width: 50px;
            height: 50px;
        }
    </style>
</head>

<body>
    <div style="padding: 20px 20px 20px 20px;">
        <table style="font-size: 32px; border-collapse: collapse;">
            <tr>
                <td id="r1c1">1</td>
                <td id="r1c2">2</td>
                <td id="r1c3">3</td>
                <td id="r1c4" style="background-color: rgb(244, 246, 246);">1</td>
                <td id="r1c5" style="background-color: rgb(244, 246, 246);">2</td>
                <td id="r1c6" style="background-color: rgb(244, 246, 246);">3</td>
                <td id="r1c7">1</td>
                <td id="r1c8">2</td>
                <td id="r1c9">3</td>
            </tr>
            <tr>
                <td id="r2c1">4</td>
                <td id="r2c2">5</td>
                <td id="r2c3">6</td>
                <td id="r2c4" style="background-color: rgb(244, 246, 246);">4</td>
                <td id="r2c5" style="background-color: rgb(244, 246, 246);">5</td>
                <td id="r2c6" style="background-color: rgb(244, 246, 246);">6</td>
                <td id="r2c7">4</td>
                <td id="r2c8">5</td>
                <td id="r2c9">6</td>
            </tr>
            <tr>
                <td id="r3c1">7</td>
                <td id="r3c2">8</td>
                <td id="r3c3">9</td>
                <td id="r3c4" style="background-color: rgb(244, 246, 246);">7</td>
                <td id="r3c5" style="background-color: rgb(244, 246, 246);">8</td>
                <td id="r3c6" style="background-color: rgb(244, 246, 246);">9</td>
                <td id="r3c7">7</td>
                <td id="r3c8">8</td>
                <td id="r3c9">9</td>
            </tr>
            <tr>
                <td id="r4c1" style="background-color: rgb(244, 246, 246);">1</td>
                <td id="r4c2" style="background-color: rgb(244, 246, 246);">2</td>
                <td id="r4c3" style="background-color: rgb(244, 246, 246);">3</td>
                <td id="r4c4">1</td>
                <td id="r4c5">2</td>
                <td id="r4c6">3</td>
                <td id="r4c7" style="background-color: rgb(244, 246, 246);">1</td>
                <td id="r4c8" style="background-color: rgb(244, 246, 246);">2</td>
                <td id="r4c9" style="background-color: rgb(244, 246, 246);">3</td>
            </tr>
            <tr>
                <td id="r5c1" style="background-color: rgb(244, 246, 246);">4</td>
                <td id="r5c2" style="background-color: rgb(244, 246, 246);">5</td>
                <td id="r5c3" style="background-color: rgb(244, 246, 246);">6</td>
                <td id="r5c4">4</td>
                <td id="r5c5">5</td>
                <td id="r5c6">6</td>
                <td id="r5c7" style="background-color: rgb(244, 246, 246);">4</td>
                <td id="r5c8" style="background-color: rgb(244, 246, 246);">5</td>
                <td id="r5c9" style="background-color: rgb(244, 246, 246);">6</td>
            </tr>
            <tr>
                <td id="r6c1" style="background-color: rgb(244, 246, 246);">7</td>
                <td id="r6c2" style="background-color: rgb(244, 246, 246);">8</td>
                <td id="r6c3" style="background-color: rgb(244, 246, 246);">9</td>
                <td id="r6c4">7</td>
                <td id="r6c5">8</td>
                <td id="r6c6">9</td>
                <td id="r6c7" style="background-color: rgb(244, 246, 246);">7</td>
                <td id="r6c8" style="background-color: rgb(244, 246, 246);">8</td>
                <td id="r6c9" style="background-color: rgb(244, 246, 246);">9</td>
            </tr>
            <tr>
                <td id="r7c1">1</td>
                <td id="r7c2">2</td>
                <td id="r7c3">3</td>
                <td id="r7c4" style="background-color: rgb(244, 246, 246);">1</td>
                <td id="r7c5" style="background-color: rgb(244, 246, 246);">2</td>
                <td id="r7c6" style="background-color: rgb(244, 246, 246);">3</td>
                <td id="r7c7">1</td>
                <td id="r7c8">2</td>
                <td id="r7c9">3</td>
            </tr>
            <tr>
                <td id="r8c1">4</td>
                <td id="r8c2">5</td>
                <td id="r8c3">6</td>
                <td id="r8c4" style="background-color: rgb(244, 246, 246);">4</td>
                <td id="r8c5" style="background-color: rgb(244, 246, 246);">5</td>
                <td id="r8c6" style="background-color: rgb(244, 246, 246);">6</td>
                <td id="r8c7">4</td>
                <td id="r8c8">5</td>
                <td id="r8c9">6</td>
            </tr>
            <tr>
                <td id="r9c1">7</td>
                <td id="r9c2">8</td>
                <td id="r9c3">9</td>
                <td id="r9c4" style="background-color: rgb(244, 246, 246);">7</td>
                <td id="r9c5" style="background-color: rgb(244, 246, 246);">8</td>
                <td id="r9c6" style="background-color: rgb(244, 246, 246);">9</td>
                <td id="r9c7">7</td>
                <td id="r9c8">8</td>
                <td id="r9c9">9</td>
            </tr>
            <tr>
                <td colspan=10 style="padding: 1px;">
                    <table style="font-size: 16px;">
                        <tr>
                            <td style="background-color: rgb(244, 246, 246); color: black;" draggable="true" ondragstart="drag(event, this.innerHTML);" onmouseover="$(this).css('cursor', 'pointer');">1</td>
                            <td style="background-color: rgb(244, 246, 246); color: black;" draggable="true" ondragstart="drag(event, this.innerHTML);" onmouseover="$(this).css('cursor', 'pointer');">2</td>
                            <td style="background-color: rgb(244, 246, 246); color: black;" draggable="true" ondragstart="drag(event, this.innerHTML);" onmouseover="$(this).css('cursor', 'pointer');">3</td>
                            <td style="background-color: rgb(244, 246, 246); color: black;" draggable="true" ondragstart="drag(event, this.innerHTML);" onmouseover="$(this).css('cursor', 'pointer');">4</td>
                            <td style="background-color: rgb(244, 246, 246); color: black;" draggable="true" ondragstart="drag(event, this.innerHTML);" onmouseover="$(this).css('cursor', 'pointer');">5</td>
                            <td style="background-color: rgb(244, 246, 246); color: black;" draggable="true" ondragstart="drag(event, this.innerHTML);" onmouseover="$(this).css('cursor', 'pointer');">6</td>
                            <td style="background-color: rgb(244, 246, 246); color: black;" draggable="true" ondragstart="drag(event, this.innerHTML);" onmouseover="$(this).css('cursor', 'pointer');">7</td>
                            <td style="background-color: rgb(244, 246, 246); color: black;" draggable="true" ondragstart="drag(event, this.innerHTML);" onmouseover="$(this).css('cursor', 'pointer');">8</td>
                            <td style="background-color: rgb(244, 246, 246); color: black;" draggable="true" ondragstart="drag(event, this.innerHTML);" onmouseover="$(this).css('cursor', 'pointer');">9</td>
                            <td style="background-color: rgb(244, 246, 246); color: black;" draggable="true" ondragstart="drag(event, 0);" onmouseover="$(this).css('cursor', 'pointer');">
                                <i class="eraser icon" title="Erase the number ..."></i>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td colspan=5 style="color: gray; font-size: 14px; text-align: left; border-collapse: collapse;">
                    <select class="ui dropdown" onchange="level = this.value;">
                        <option value="0.3">Easy</option>
                        <option value="0.5" selected>Medium</option>
                        <option value="0.7">Hard</option>
                    </select>
                </td>
                <td colspan=4 style="text-align: right;">
                    <div class="ui primary basic button" title="Start a new game ..." onclick="newGame();">
                        <i class="sync alternate icon"></i>
                        New Game
                    </div>
                </td>
            </tr>
        </table>
    </div>
    <script>
        let index = 0;
        let level = 0.5;
        let sudoku = [];
        const matrix = [
            "#r1c1", "#r1c2", "#r1c3", "#r1c4", "#r1c5", "#r1c6", "#r1c7", "#r1c8", "#r1c9",
            "#r2c1", "#r2c2", "#r2c3", "#r2c4", "#r2c5", "#r2c6", "#r2c7", "#r2c8", "#r2c9",
            "#r3c1", "#r3c2", "#r3c3", "#r3c4", "#r3c5", "#r3c6", "#r3c7", "#r3c8", "#r3c9",
            "#r4c1", "#r4c2", "#r4c3", "#r4c4", "#r4c5", "#r4c6", "#r4c7", "#r4c8", "#r4c9",
            "#r5c1", "#r5c2", "#r5c3", "#r5c4", "#r5c5", "#r5c6", "#r5c7", "#r5c8", "#r5c9",
            "#r6c1", "#r6c2", "#r6c3", "#r6c4", "#r6c5", "#r6c6", "#r6c7", "#r6c8", "#r6c9",
            "#r7c1", "#r7c2", "#r7c3", "#r7c4", "#r7c5", "#r7c6", "#r7c7", "#r7c8", "#r7c9",
            "#r8c1", "#r8c2", "#r8c3", "#r8c4", "#r8c5", "#r8c6", "#r8c7", "#r8c8", "#r8c9",
            "#r9c1", "#r9c2", "#r9c3", "#r9c4", "#r9c5", "#r9c6", "#r9c7", "#r9c8", "#r9c9"
        ];

        function allowDrop(ev) {
            ev.preventDefault();
        }   // allow drop event

        function drag(ev, v) {
            ev.dataTransfer.setData("Text", v);
        }   // drag a number

        function drop(ev) {
            let win = true;
            ev.preventDefault();
            ev.target.innerHTML = ev.dataTransfer.getData("Text") == 0 ? " " : ev.dataTransfer.getData("Text");

            for (let i = 0; i < sudoku[index].length; i++) {
                if ($(matrix[i]).val() == " ") {
                    win = false; continue;
                }   // cell is empty

                if ($(matrix[i]).html() == sudoku[index][i]) {
                    $(matrix[i]).css("color", "rgb(77, 77, 77)");
                } else {
                    $(matrix[i]).css("color", "red"); win = false;
                }   // number is incorrect
            }

            if (win) {
                window.alert("Congratulations, You Win!"); newGame();
            }   // complete the sudoku matrix
        }   // drop a number; also check for win

        function newGame() {
            index = Math.floor(Math.random() * sudoku.length);

            for (let i = 0; i < sudoku[index].length; i++) {
                $(matrix[i]).css("color", "rgb(77, 77, 77)");

                if (Math.random() > level) {
                    $(matrix[i]).removeAttr("ondrop");
                    $(matrix[i]).removeAttr("ondragover");
                    $(matrix[i]).html(sudoku[index][i]);
                } else {
                    $(matrix[i]).attr("ondrop", "drop(event);");
                    $(matrix[i]).attr("ondragover", "allowDrop(event);");
                    $(matrix[i]).html(" ");
                }   // drop the number
            }
        }   // generate a new game

        $(document).ready(function() {
            $.getJSON("matrix.json", function(m) {
                sudoku = m;
            });

            $('.ui.dropdown').dropdown();
        }); // load all blocks
    </script>
</body>

</html>
